/**
 * Imperium 4X (Web) - Display Manager
 * ===
 *
 * @module displayManager
 */

////////////////////////////////////////////////////////////////////////////////
// Imports
////////////////////////////////////////////////////////////////////////////////
import Screen from './screen';

//////////////////////////////////////////////////////////////////////////////
// Public Properties
//////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// Class
////////////////////////////////////////////////////////////////////////////////
class DisplayManager {

  //////////////////////////////////////////////////////////////////////////////
  // Private Properties
  //////////////////////////////////////////////////////////////////////////////
  _messageBus;
  _screens;

  //////////////////////////////////////////////////////////////////////////////
  // Public Properties
  //////////////////////////////////////////////////////////////////////////////

  constructor(messageBus){
    this._messageBus = messageBus || {};
    this._screens = {};

    this._init(config);
  }

  //////////////////////////////////////////////////////////////////////////////
  // Public Methods
  //////////////////////////////////////////////////////////////////////////////
  render(sprites){
    for(let key in this._screens){
      let screen = this._screens[key];
      screen.render(sprites);
    }
  }

  //////////////////////////////////////////////////////////////////////////////
  // Private Methods
  //////////////////////////////////////////////////////////////////////////////
  _init(config){
    const UI = config.UI;
    const MESSAGES = config.MESSAGES;
    this._messageBus.subscribe(MESSAGES.INPUT_EVENT, (x) => this.handleInputEvent(x));
    this._rootElement = document.getElementById(config.UI.ROOT_ELEMENT_ID);

    let windows = config.UI.WINDOWS;

    windows.forEach((obj) => {
      this._createScreen(obj);
    });
  }

  _createScreen(settings){
    let screen = Screen.create(settings);
    this._screens[settings.id] = screen;
    let element = screen.element;
    this._rootElement.append(element);
  }

}

////////////////////////////////////////////////////////////////////////////////
// Exports
////////////////////////////////////////////////////////////////////////////////
export default DisplayManager;